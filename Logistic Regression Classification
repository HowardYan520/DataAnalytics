{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np \n",
    "from sklearn import linear_model\n",
    "import matplotlib.pyplot as plt\n",
    "from scipy.special import expit"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Insurance Binary Classification "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "df=pd.read_csv(\"/Users/howardyan/Desktop/Data Accelerator/Logistic Regression/insurance_data.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>bought_insurance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>52</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>46</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   age  bought_insurance\n",
       "0   22                 0\n",
       "1   25                 0\n",
       "2   47                 1\n",
       "3   52                 0\n",
       "4   46                 1"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x7fd740c94490>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "plt.xlabel('age')\n",
    "plt.ylabel('bought_insurance')\n",
    "plt.scatter(df.age,df.bought_insurance,color='red',marker='+')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## We split the set into the training and test sets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "90% of the test set is used for training. 10% will be used for testing. Also, use shift tab to understand functions!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train,X_test,Y_train,Y_test=train_test_split(df[['age']],df.bought_insurance,test_size=0.1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    age\n",
       "7    60\n",
       "15   55\n",
       "1    25"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": [
    "model=LogisticRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,\n",
       "                   intercept_scaling=1, l1_ratio=None, max_iter=100,\n",
       "                   multi_class='auto', n_jobs=None, penalty='l2',\n",
       "                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,\n",
       "                   warm_start=False)"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(X_train,Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 1, 0])"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.0"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.score(X_test,Y_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "What is the probability of each individual in our test set purchasing insurance? No and Yes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.06517842, 0.93482158],\n",
       "       [0.1158065 , 0.8841935 ],\n",
       "       [0.85196252, 0.14803748]])"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.predict_proba(X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Logistic Regression Model "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>bought_insurance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>22</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>52</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>46</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   age  bought_insurance\n",
       "0   22                 0\n",
       "1   25                 0\n",
       "2   47                 1\n",
       "3   52                 0\n",
       "4   46                 1"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df=pd.read_csv(\"/Users/howardyan/Desktop/Data Accelerator/Logistic Regression/insurance_data.csv\")\n",
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "n=1000\n",
    "array=np.arange(n)\n",
    "for i in np.arange(n):\n",
    "    X_train,X_test,Y_train,Y_test=train_test_split(df[['age']],df.bought_insurance,test_size=0.1)\n",
    "    model=LogisticRegression()\n",
    "    model.fit(X_train,Y_train)\n",
    "    model.predict(X_test)\n",
    "    array[i]=model.score(X_test,Y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "from itertools import repeat\n",
    "a=np.repeat(np.mean(array),n)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.646"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "x_axis=np.arange(n)\n",
    "plt.plot(x_axis,array)\n",
    "plt.plot(x_axis,a)\n",
    "np.mean(array)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "round(0.65,1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " ## THE HR EXAMPLE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "hr=pd.read_csv(\"/Users/howardyan/Desktop/Data Accelerator/Logistic Regression/HR.zip\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>satisfaction_level</th>\n",
       "      <th>last_evaluation</th>\n",
       "      <th>number_project</th>\n",
       "      <th>average_montly_hours</th>\n",
       "      <th>time_spend_company</th>\n",
       "      <th>Work_accident</th>\n",
       "      <th>left</th>\n",
       "      <th>promotion_last_5years</th>\n",
       "      <th>Department</th>\n",
       "      <th>salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.38</td>\n",
       "      <td>0.53</td>\n",
       "      <td>2</td>\n",
       "      <td>157</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>sales</td>\n",
       "      <td>low</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.80</td>\n",
       "      <td>0.86</td>\n",
       "      <td>5</td>\n",
       "      <td>262</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>sales</td>\n",
       "      <td>medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.11</td>\n",
       "      <td>0.88</td>\n",
       "      <td>7</td>\n",
       "      <td>272</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>sales</td>\n",
       "      <td>medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.72</td>\n",
       "      <td>0.87</td>\n",
       "      <td>5</td>\n",
       "      <td>223</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>sales</td>\n",
       "      <td>low</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.37</td>\n",
       "      <td>0.52</td>\n",
       "      <td>2</td>\n",
       "      <td>159</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>sales</td>\n",
       "      <td>low</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   satisfaction_level  last_evaluation  number_project  average_montly_hours  \\\n",
       "0                0.38             0.53               2                   157   \n",
       "1                0.80             0.86               5                   262   \n",
       "2                0.11             0.88               7                   272   \n",
       "3                0.72             0.87               5                   223   \n",
       "4                0.37             0.52               2                   159   \n",
       "\n",
       "   time_spend_company  Work_accident  left  promotion_last_5years Department  \\\n",
       "0                   3              0     1                      0      sales   \n",
       "1                   6              0     1                      0      sales   \n",
       "2                   4              0     1                      0      sales   \n",
       "3                   5              0     1                      0      sales   \n",
       "4                   3              0     1                      0      sales   \n",
       "\n",
       "   salary  \n",
       "0     low  \n",
       "1  medium  \n",
       "2  medium  \n",
       "3     low  \n",
       "4     low  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hr.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>satisfaction_level</th>\n",
       "      <th>last_evaluation</th>\n",
       "      <th>number_project</th>\n",
       "      <th>average_montly_hours</th>\n",
       "      <th>time_spend_company</th>\n",
       "      <th>Work_accident</th>\n",
       "      <th>promotion_last_5years</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>left</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.666810</td>\n",
       "      <td>0.715473</td>\n",
       "      <td>3.786664</td>\n",
       "      <td>199.060203</td>\n",
       "      <td>3.380032</td>\n",
       "      <td>0.175009</td>\n",
       "      <td>0.026251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.440098</td>\n",
       "      <td>0.718113</td>\n",
       "      <td>3.855503</td>\n",
       "      <td>207.419210</td>\n",
       "      <td>3.876505</td>\n",
       "      <td>0.047326</td>\n",
       "      <td>0.005321</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      satisfaction_level  last_evaluation  number_project  \\\n",
       "left                                                        \n",
       "0               0.666810         0.715473        3.786664   \n",
       "1               0.440098         0.718113        3.855503   \n",
       "\n",
       "      average_montly_hours  time_spend_company  Work_accident  \\\n",
       "left                                                            \n",
       "0               199.060203            3.380032       0.175009   \n",
       "1               207.419210            3.876505       0.047326   \n",
       "\n",
       "      promotion_last_5years  \n",
       "left                         \n",
       "0                  0.026251  \n",
       "1                  0.005321  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hr.groupby('left').mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "import seaborn as sns\n",
    "from matplotlib import pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>satisfaction_level</th>\n",
       "      <th>last_evaluation</th>\n",
       "      <th>number_project</th>\n",
       "      <th>average_montly_hours</th>\n",
       "      <th>time_spend_company</th>\n",
       "      <th>Work_accident</th>\n",
       "      <th>promotion_last_5years</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>left</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.666810</td>\n",
       "      <td>0.715473</td>\n",
       "      <td>3.786664</td>\n",
       "      <td>199.060203</td>\n",
       "      <td>3.380032</td>\n",
       "      <td>0.175009</td>\n",
       "      <td>0.026251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.440098</td>\n",
       "      <td>0.718113</td>\n",
       "      <td>3.855503</td>\n",
       "      <td>207.419210</td>\n",
       "      <td>3.876505</td>\n",
       "      <td>0.047326</td>\n",
       "      <td>0.005321</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      satisfaction_level  last_evaluation  number_project  \\\n",
       "left                                                        \n",
       "0               0.666810         0.715473        3.786664   \n",
       "1               0.440098         0.718113        3.855503   \n",
       "\n",
       "      average_montly_hours  time_spend_company  Work_accident  \\\n",
       "left                                                            \n",
       "0               199.060203            3.380032       0.175009   \n",
       "1               207.419210            3.876505       0.047326   \n",
       "\n",
       "      promotion_last_5years  \n",
       "left                         \n",
       "0                  0.026251  \n",
       "1                  0.005321  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "salaries=hr.groupby('left').mean()\n",
    "salaries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['satisfaction_level', 'last_evaluation', 'number_project',\n",
       "       'average_montly_hours', 'time_spend_company', 'Work_accident', 'left',\n",
       "       'promotion_last_5years', 'Department', 'salary'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hr.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>satisfaction_level</th>\n",
       "      <th>last_evaluation</th>\n",
       "      <th>number_project</th>\n",
       "      <th>average_montly_hours</th>\n",
       "      <th>time_spend_company</th>\n",
       "      <th>Work_accident</th>\n",
       "      <th>promotion_last_5years</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>left</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.666810</td>\n",
       "      <td>0.715473</td>\n",
       "      <td>3.786664</td>\n",
       "      <td>199.060203</td>\n",
       "      <td>3.380032</td>\n",
       "      <td>0.175009</td>\n",
       "      <td>0.026251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.440098</td>\n",
       "      <td>0.718113</td>\n",
       "      <td>3.855503</td>\n",
       "      <td>207.419210</td>\n",
       "      <td>3.876505</td>\n",
       "      <td>0.047326</td>\n",
       "      <td>0.005321</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      satisfaction_level  last_evaluation  number_project  \\\n",
       "left                                                        \n",
       "0               0.666810         0.715473        3.786664   \n",
       "1               0.440098         0.718113        3.855503   \n",
       "\n",
       "      average_montly_hours  time_spend_company  Work_accident  \\\n",
       "left                                                            \n",
       "0               199.060203            3.380032       0.175009   \n",
       "1               207.419210            3.876505       0.047326   \n",
       "\n",
       "      promotion_last_5years  \n",
       "left                         \n",
       "0                  0.026251  \n",
       "1                  0.005321  "
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hr.groupby('left').mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>satisfaction_level</th>\n",
       "      <th>average_montly_hours</th>\n",
       "      <th>Work_accident</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.38</td>\n",
       "      <td>157</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.80</td>\n",
       "      <td>262</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.11</td>\n",
       "      <td>272</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.72</td>\n",
       "      <td>223</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.37</td>\n",
       "      <td>159</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14994</th>\n",
       "      <td>0.40</td>\n",
       "      <td>151</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14995</th>\n",
       "      <td>0.37</td>\n",
       "      <td>160</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14996</th>\n",
       "      <td>0.37</td>\n",
       "      <td>143</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14997</th>\n",
       "      <td>0.11</td>\n",
       "      <td>280</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14998</th>\n",
       "      <td>0.37</td>\n",
       "      <td>158</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14999 rows  3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       satisfaction_level  average_montly_hours  Work_accident\n",
       "0                    0.38                   157              0\n",
       "1                    0.80                   262              0\n",
       "2                    0.11                   272              0\n",
       "3                    0.72                   223              0\n",
       "4                    0.37                   159              0\n",
       "...                   ...                   ...            ...\n",
       "14994                0.40                   151              0\n",
       "14995                0.37                   160              0\n",
       "14996                0.37                   143              0\n",
       "14997                0.11                   280              0\n",
       "14998                0.37                   158              0\n",
       "\n",
       "[14999 rows x 3 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hr[['satisfaction_level','average_montly_hours','Work_accident']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train,X_test,Y_train,Y_test=train_test_split(hr[['average_montly_hours']],hr.satisfaction_level,test_size=0.2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>average_montly_hours</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14509</th>\n",
       "      <td>136</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8307</th>\n",
       "      <td>253</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12943</th>\n",
       "      <td>191</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12915</th>\n",
       "      <td>175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1112</th>\n",
       "      <td>251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9426</th>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7118</th>\n",
       "      <td>267</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12710</th>\n",
       "      <td>252</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10808</th>\n",
       "      <td>185</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1008</th>\n",
       "      <td>256</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3000 rows  1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       average_montly_hours\n",
       "14509                   136\n",
       "8307                    253\n",
       "12943                   191\n",
       "12915                   175\n",
       "1112                    251\n",
       "...                     ...\n",
       "9426                    218\n",
       "7118                    267\n",
       "12710                   252\n",
       "10808                   185\n",
       "1008                    256\n",
       "\n",
       "[3000 rows x 1 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "model=LogisticRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Unknown label type: 'continuous'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-34-ffa49499a3bf>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mY_train\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m~/opt/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[1;32m   1526\u001b[0m         X, y = check_X_y(X, y, accept_sparse='csr', dtype=_dtype, order=\"C\",\n\u001b[1;32m   1527\u001b[0m                          accept_large_sparse=solver != 'liblinear')\n\u001b[0;32m-> 1528\u001b[0;31m         \u001b[0mcheck_classification_targets\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1529\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclasses_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0munique\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1530\u001b[0m         \u001b[0mn_samples\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_features\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/opt/anaconda3/lib/python3.7/site-packages/sklearn/utils/multiclass.py\u001b[0m in \u001b[0;36mcheck_classification_targets\u001b[0;34m(y)\u001b[0m\n\u001b[1;32m    167\u001b[0m     if y_type not in ['binary', 'multiclass', 'multiclass-multioutput',\n\u001b[1;32m    168\u001b[0m                       'multilabel-indicator', 'multilabel-sequences']:\n\u001b[0;32m--> 169\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Unknown label type: %r\"\u001b[0m \u001b[0;34m%\u001b[0m \u001b[0my_type\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    170\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    171\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: Unknown label type: 'continuous'"
     ]
    }
   ],
   "source": [
    "model.fit(X_train,Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "(model.predict(X_test))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "model.score(X_test,Y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "plt.scatter(X_test,Y_test)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## USING SALARY"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "hr['dummy_salary']=hr.salary.map({'low':0,'medium':0,'high':1})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "hr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train,X_test,Y_train,Y_test=train_test_split(hr[['dummy_salary']],hr.left,test_size=0.2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "model=LogisticRegression()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "model.fit(X_train,Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "model.score(X_test,Y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "hr[['dummy_salary']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
